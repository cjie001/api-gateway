{
  "rules": [
    {
      "uris": [
        "/payment"
      ],
      "route_key_map": {
        "*": "route_default"
      },
      "routes": {
        "route_default": {
          "upstream_id": "default_servers"
        }
      }
    },
    {
      "uris": [
        "/api",
        "/api_dev"
      ],
      "route_key_source": "${JSONBODY['body.mchntCd']}",
      "route_key_map": {
        "1234567890": "route_trade_activity",
        "9876543210": "route_vip",
        "*": "route_default"
      },
      "routes": {
        "route_trade_activity": {
          "rewrite": "^/trade(.*)$ /mock/trade_activity$1",
          "upstream_id": "activity_servers"
        },
        "route_vip": {
          "rewrite": "^/trade(.*)$ /mock/trade$1",
          "upstream_id": "vip_servers"
        },
        "route_default": {
          "rewrite": "^/trade(.*)$ /mock/trade$1",
          "upstream_id": "default_servers"
        }
      }
    },
    {
      "uris": [
        "/api_prod"
      ],
      "route_key_source": "${BODY['\"mchntCd\"%s*:%s*\"([^\"]+)\"']}",
      "route_key_map": {
        "1234567890": "route_trade_activity",
        "9876543210": "route_vip",
        "*": "route_default"
      },
      "routes": {
        "route_trade_activity": {
          "rewrite": "^/trade(.*)$ /mock/trade_activity$1",
          "rate_limit": {
            "strategy": "req",
            "rate": 100,
            "burst": 50,
            "window": 60,
            "count": 1000,
            "delay": 0.5,
            "key_template": "${BODY['\"mchntCd\"%s*:%s*\"([^\"]+)\"']}"
          },
          "circuit_break": {
            "failure_threshold": 50,
            "success_threshold": 10,
            "timeout": 30
          },
          "upstream_id": "activity_servers"
        },
        "route_vip": {
          "rewrite": "^/api_prod/(.*)$ /mock/trade$1",
          "upstream_id": "vip_servers"
        },
        "route_default": {
          "rewrite": "^/api_prod/(.*)$ /mock/trade$1",
          "upstream_id": "default_servers"
        }
      }
    }
  ],
  "upstreams": {
    "vip_servers": [
      {
        "host": "127.0.0.1",
        "port": 9001,
        "weight": 1
      }
    ],
    "activity_servers": [
      {
        "host": "127.0.0.1",
        "port": 9001,
        "weight": 70
      },
      {
        "host": "127.0.0.1",
        "port": 9001,
        "weight": 30
      }
    ],
    "default_servers": [
      {
        "host": "127.0.0.1",
        "port": 9001,
        "weight": 1
      }
    ]
  },
  "rules_api_url": "http://127.0.0.1:9001/mock/latest_rules"
}
